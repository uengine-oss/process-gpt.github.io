import{c as ue,_ as ce}from"./index-82a3ef9a.js";import"./ChatDetail.vue_vue_type_style_index_0_lang-18b9bb84.js";import{_ as me,a as pe}from"./ChatProfile-d853de6b.js";import{_ as I,s as A,o as f,c as b,b as i,w as n,aj as j,ae as C,$ as ee,L as T,M as q,x as V,a2 as k,aG as S,S as E,V as g,J as M,av as U,d as p,z as w,ah as he,aS as J,am as x,aT as fe,aq as N,aU as ve,ay as W,ax as ye,ao as te,ap as H,aH as oe,F as K,al as P,aw as z,ak as L,aJ as ae,aK as ie,a as v,a3 as ge,aV as _e,aB as ne,aW as Z,aX as Q,aC as be,aA as Se,aF as Y}from"./index-dcd728bc.js";import{V as O}from"./VSheet-42154d36.js";import{V as se,a as R}from"./VWindowItem-1543f0aa.js";import{C as Ce,U as we,T as Te,B as Ae,L as ke,F as Ve,R as De,a as Ee,S as Me,b as Ue,_ as Fe}from"./DynamicForm-d987c0fb.js";import{_ as Pe}from"./AppBaseCard.vue_vue_type_style_index_0_lang-86309e8f.js";import{C as $e}from"./Chat-1fd8903b.js";import"./VAlert-d5b63406.js";/* empty css                                                    */import"./index-18289fd3.js";import"./chat-icon-7da84487.js";const Ie={name:"FormDefinitionPanelItemTable",props:{modelValue:Array},data(){return{localModelValue:this.modelValue,keyToAdd:"",valueToAdd:"",itemIndexToEdit:-1,keyToEdit:"",valueToEdit:"",placeholder:{valueToAdd:"",valueToEdit:""},regexStr:/^[가-힣a-zA-Z0-9_\-. ]+$/,regexErrorMsg:"'{{propName}}'은 한글, 영문, 숫자, 공백, 밑줄(_), 대시(-), 점(.) 만 입력 가능합니다!"}},watch:{modelValue:{handler(){this.localModelValue=this.modelValue},deep:!0,immediate:!0},localModelValue:{handler(){this.$emit("update:modelValue",this.localModelValue)},deep:!0,immediate:!0}},methods:{addItem(){if(!this.keyToAdd||this.keyToAdd.length<=0){alert("Key is required"),this.$refs.inputKeyToAddItem.focus();return}if(!this.regexStr.test(this.keyToAdd)){alert(this.regexErrorMsg.replace("{{propName}}","Key")),this.$refs.inputKeyToAddItem.focus();return}if(this.localModelValue.some(e=>e.hasOwnProperty(this.keyToAdd))){alert("Key already exists"),this.$refs.inputKeyToAddItem.focus();return}if(this.valueToAdd&&this.valueToAdd.length>0&&!this.regexStr.test(this.valueToAdd)){alert(this.regexErrorMsg.replace("{{propName}}","Value")),this.$refs.inputValueToAddItem.focus();return}(!this.valueToAdd||this.valueToAdd.length<=0)&&(this.valueToAdd=this.keyToAdd),this.localModelValue.push({[this.keyToAdd]:this.valueToAdd}),this.keyToAdd="",this.valueToAdd="",this.placeholder.valueToAdd="",this.$nextTick(()=>{this.$refs.inputKeyToAddItem.focus()})},editItem(e){if(!this.keyToEdit||this.keyToEdit.length<=0){alert("Key is required"),this.$refs.inputKeyToEditItem[0].focus();return}if(!this.regexStr.test(this.keyToEdit)){alert(this.regexErrorMsg.replace("{{propName}}","Key")),this.$refs.inputKeyToEditItem[0].focus();return}if(!this.localModelValue[e].hasOwnProperty(this.keyToEdit)&&this.localModelValue.some(t=>t.hasOwnProperty(this.keyToEdit))){alert("Key already exists"),this.$refs.inputKeyToEditItem[0].focus();return}if(this.valueToEdit&&this.valueToEdit.length>0&&!this.regexStr.test(this.valueToEdit)){alert(this.regexErrorMsg.replace("{{propName}}","Value")),this.$refs.inputValueToEditItem[0].focus();return}(!this.valueToEdit||this.valueToEdit.length<=0)&&(this.valueToEdit=this.keyToEdit),this.localModelValue.splice(e,1,{[this.keyToEdit]:this.valueToEdit}),this.itemIndexToEdit=-1,this.keyToEdit="",this.valueToEdit="",this.placeholder.valueToEdit=""},deleteItem(e){this.localModelValue.splice(e,1)},onInputKeyToAdd(){this.placeholder.valueToAdd=this.keyToAdd},onInputKeyToEdit(){this.placeholder.valueToEdit=this.keyToEdit}}},Oe=p(" KEY "),Ne=p(" VALUE "),Le=p("mdi-close"),Ke=p("mdi-plus");function xe(e,t,c,l,r,a){const o=A("PencilIcon"),s=A("TrashIcon");return f(),b("div",null,[i(he,null,{default:n(()=>[i(j,null,{default:n(()=>[i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[Oe]),_:1}),i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[Ne]),_:1}),i(C,{cols:"2",class:"d-flex align-center justify-center"})]),_:1}),i(ee,{class:"my-4"}),(f(!0),b(T,null,q(r.localModelValue,(u,d)=>(f(),V(j,{key:d},{default:n(()=>[(f(!0),b(T,null,q(u,(m,_)=>(f(),b(T,{key:_},[d===r.itemIndexToEdit?(f(),b(T,{key:0},[i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[i(k,{ref_for:!0,ref:"inputKeyToEditItem",class:"centered-input",label:"Key",modelValue:r.keyToEdit,"onUpdate:modelValue":t[0]||(t[0]=y=>r.keyToEdit=y),modelModifiers:{trim:!0},rules:[y=>!!y||"Key is required"],required:"",onKeyup:S(y=>a.editItem(d),["enter"]),onInput:a.onInputKeyToEdit,"persistent-placeholder":""},null,8,["modelValue","rules","onKeyup","onInput"])]),_:2},1024),i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[i(k,{ref_for:!0,ref:"inputValueToEditItem",class:"centered-input",label:"Value",modelValue:r.valueToEdit,"onUpdate:modelValue":t[1]||(t[1]=y=>r.valueToEdit=y),modelModifiers:{trim:!0},onKeyup:S(y=>a.editItem(d),["enter"]),placeholder:r.placeholder.valueToEdit,"persistent-placeholder":""},null,8,["modelValue","onKeyup","placeholder"])]),_:2},1024),i(C,{cols:"2",class:"d-flex align-center justify-center"},{default:n(()=>[i(O,{class:"pb-5"},{default:n(()=>[i(E,{text:e.$t("uiDefinition.cancel")},{activator:n(({props:y})=>[i(g,M({icon:"",flat:"",onClick:t[2]||(t[2]=h=>r.itemIndexToEdit=-1)},y),{default:n(()=>[i(U,{style:{color:"red"}},{default:n(()=>[Le]),_:1})]),_:2},1040)]),_:1},8,["text"])]),_:1}),i(O,{class:"pb-5"},{default:n(()=>[i(E,{text:e.$t("uiDefinition.edit")},{activator:n(({props:y})=>[i(g,M({icon:"",flat:"",onClick:h=>a.editItem(d)},y),{default:n(()=>[i(o,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),_:2},1024)]),_:2},1024)],64)):(f(),b(T,{key:1},[i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[p(w(_),1)]),_:2},1024),i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[p(w(m),1)]),_:2},1024),i(C,{cols:"2",class:"d-flex align-center justify-center"},{default:n(()=>[i(O,null,{default:n(()=>[i(E,{text:e.$t("uiDefinition.edit")},{activator:n(({props:y})=>[i(g,M({icon:"",flat:"",onClick:h=>{r.itemIndexToEdit=d,r.keyToEdit=_,r.valueToEdit=m,r.placeholder.valueToEdit=_}},y),{default:n(()=>[i(o,{"stroke-width":"1.5",size:"20",class:"text-primary"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),_:2},1024),i(O,null,{default:n(()=>[i(E,{text:e.$t("uiDefinition.delete")},{activator:n(({props:y})=>[i(g,M({icon:"",flat:"",onClick:h=>a.deleteItem(d)},y),{default:n(()=>[i(s,{"stroke-width":"1.5",size:"20",class:"text-error"})]),_:2},1040,["onClick"])]),_:2},1032,["text"])]),_:2},1024)]),_:2},1024)],64))],64))),128))]),_:2},1024))),128)),i(j,null,{default:n(()=>[i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[i(k,{ref:"inputKeyToAddItem",class:"centered-input",label:"Key",modelValue:r.keyToAdd,"onUpdate:modelValue":t[3]||(t[3]=u=>r.keyToAdd=u),modelModifiers:{trim:!0},onKeyup:S(a.addItem,["enter"]),onInput:a.onInputKeyToAdd,"persistent-placeholder":""},null,8,["modelValue","onKeyup","onInput"])]),_:1}),i(C,{cols:"5",class:"d-flex align-center justify-center"},{default:n(()=>[i(k,{ref:"inputValueToAddItem",class:"centered-input",label:"Value",modelValue:r.valueToAdd,"onUpdate:modelValue":t[4]||(t[4]=u=>r.valueToAdd=u),modelModifiers:{trim:!0},onKeyup:S(a.addItem,["enter"]),placeholder:r.placeholder.valueToAdd,"persistent-placeholder":""},null,8,["modelValue","onKeyup","placeholder"])]),_:1}),i(C,{cols:"2",class:"d-flex align-center justify-center pb-9"},{default:n(()=>[i(O,null,{default:n(()=>[i(E,{text:e.$t("uiDefinition.add")},{activator:n(({props:u})=>[i(g,M({icon:"",flat:"",onClick:a.addItem},u),{default:n(()=>[i(U,{style:{color:"green"},size:"40"},{default:n(()=>[Ke]),_:1})]),_:2},1040,["onClick"])]),_:1},8,["text"])]),_:1})]),_:1})]),_:1})]),_:1})])}const He=I(Ie,[["render",xe]]);const Re={name:"form-definition-panel",components:{FormDefinitionPanelItemTable:He},emits:["onClose","onSave"],props:{componentRef:Object},data:()=>({componentProps:{},isHelpDialogOpen:!1}),methods:{save(){for(const e of this.componentRef.settingInfos){if(!e.validCheck)continue;const t=e.validCheck(this.componentProps[e.dataToUse],this.componentProps);if(t){alert(t),this.$refs[e.dataToUse]&&this.$refs[e.dataToUse][0].focus();return}}this.componentRef.settingInfos.forEach(e=>{e.addOns&&e.addOns.includes("encodedAsBase64")&&(this.componentProps[e.dataToUse]=btoa(encodeURIComponent(this.componentProps[e.dataToUse])))}),this.$emit("onSave",this.componentRef,this.componentProps)},isShowCheck(e){return e.isShowCheck?e.isShowCheck(this.componentProps):!0}},mounted(){this.componentProps=this.componentRef.settingInfos.reduce((e,t)=>(t.settingType==="items"?e[t.dataToUse]=JSON.parse(JSON.stringify(this.componentRef[t.dataToUse])):t.addOns&&t.addOns.includes("encodedAsBase64")?e[t.dataToUse]=decodeURIComponent(atob(this.componentRef[t.dataToUse])):e[t.dataToUse]=this.componentRef[t.dataToUse],e),{}),this.$nextTick(()=>{Object.keys(this.$refs).length>0&&this.$refs[Object.keys(this.$refs)[0]][0].focus()})}},D=e=>(ae("data-v-079e7b84"),e=e(),ie(),e),je=p(" Edit Form Attribute "),Be=p("mdi-close"),qe=p("mdi-help-circle"),Je=p("Fixed Options"),We=p("Data Binding"),ze=p(" Apply "),Ge=p(w("Code Help")),Ze=p("mdi-close"),Qe=D(()=>v("h3",null,"- 예제 1: 입력된 폼 내용 출력",-1)),Ye=D(()=>v("p",null,[p('alert(this.formValues["email"])'),v("br"),p('// "email" Name 속성을 가진 값을 출력')],-1)),Xe=D(()=>v("br",null,null,-1)),et=D(()=>v("h3",null,"- 예제 2: 폼 내용을 변경",-1)),tt=D(()=>v("p",null,[p('this.formValues["email"] = "new email"'),v("br"),p('// "email" Name 속성을 가진 값을 변경')],-1)),ot=D(()=>v("br",null,null,-1)),at=D(()=>v("h3",null,"- 예제 3: 폼 내용 검사 후 에러메시지 반환",-1)),it=D(()=>v("p",null,[p('if(this.formValues["email"] === "") error = "email is required"'),v("br"),p(' // "email" Name 속성을 가진 값이 비어있으면 에러 메시지 반환'),v("br"),p(' // "Event Type"이 반드시 "validate"로 설정되어 있어야 함')],-1)),nt=D(()=>v("br",null,null,-1)),st=D(()=>v("h3",null,"- 예제 4: 여러 줄 입력",-1)),lt=D(()=>v("p",null,[p('alert("line1");'),v("br"),p('alert("line2");')],-1)),rt=p('// 여러 줄 입력시 각 라인의 끝에 ";"를 붙여야 함 '),dt=p(" OK ");function ut(e,t,c,l,r,a){const o=A("FormDefinitionPanelItemTable");return f(),b(T,null,[i(P,{class:"mx-auto my-8",elevation:"16","max-width":"600"},{default:n(()=>[i(J,null,{default:n(()=>[i(x,null,{default:n(()=>[je]),_:1}),i(fe,null,{default:n(()=>[p(" type: "+w(c.componentRef.tagName),1)]),_:1}),i(g,{icon:"",style:{position:"absolute",right:"5px",top:"5px"},onClick:t[0]||(t[0]=s=>e.$emit("onClose"))},{default:n(()=>[i(U,null,{default:n(()=>[Be]),_:1})]),_:1})]),_:1}),i(N,null,{default:n(()=>[(f(!0),b(T,null,q(c.componentRef.settingInfos,(s,u)=>(f(),b(T,{key:u},[s.settingType==="text"&&a.isShowCheck(s)?(f(),V(k,{key:0,ref_for:!0,ref:s.dataToUse,label:s.settingLabel,modelValue:e.componentProps[s.dataToUse],"onUpdate:modelValue":d=>e.componentProps[s.dataToUse]=d,modelModifiers:{trim:!0},onKeyup:S(a.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","onKeyup"])):s.settingType==="number"&&a.isShowCheck(s)?(f(),V(k,{key:1,type:"number",ref_for:!0,ref:s.dataToUse,label:s.settingLabel,modelValue:e.componentProps[s.dataToUse],"onUpdate:modelValue":d=>e.componentProps[s.dataToUse]=d,modelModifiers:{trim:!0},onKeyup:S(a.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","onKeyup"])):s.settingType==="textarea_code"&&a.isShowCheck(s)?(f(),b(T,{key:2},[i(ve,{class:"text-subtitle-1 font-weight-medium"},{default:n(()=>[p(w(s.settingLabel)+" ",1),i(g,{icon:"",onClick:t[1]||(t[1]=d=>e.isHelpDialogOpen=!0),style:{width:"24px",height:"24px"},class:"ml-2"},{default:n(()=>[i(U,null,{default:n(()=>[qe]),_:1})]),_:1})]),_:2},1024),i(ee,{class:"my-3"}),i(W,{ref_for:!0,ref:s.dataToUse,modelValue:e.componentProps[s.dataToUse],"onUpdate:modelValue":d=>e.componentProps[s.dataToUse]=d,modelModifiers:{trim:!0},rows:s.rows??5,"persistent-placeholder":""},null,8,["modelValue","onUpdate:modelValue","rows"])],64)):s.settingType==="textarea"&&a.isShowCheck(s)?(f(),V(W,{key:3,ref_for:!0,ref:s.dataToUse,label:s.settingLabel,modelValue:e.componentProps[s.dataToUse],"onUpdate:modelValue":d=>e.componentProps[s.dataToUse]=d,modelModifiers:{trim:!0},rows:s.rows??5,"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","rows"])):s.settingType==="select"&&a.isShowCheck(s)?(f(),V(ye,{key:4,ref_for:!0,ref:s.dataToUse,label:s.settingLabel,modelValue:e.componentProps[s.dataToUse],"onUpdate:modelValue":d=>e.componentProps[s.dataToUse]=d,items:s.settingValue,onKeyup:S(a.save,["enter"]),"persistent-placeholder":""},null,8,["label","modelValue","onUpdate:modelValue","items","onKeyup"])):s.settingType==="items"&&a.isShowCheck(s)?(f(),b(T,{key:5},[i(te,{modelValue:e.componentProps.localIsDynamicLoad,"onUpdate:modelValue":t[2]||(t[2]=d=>e.componentProps.localIsDynamicLoad=d),class:"text-black","fixed-tabs":""},{default:n(()=>[i(H,{value:!1},{default:n(()=>[Je]),_:1}),i(H,{value:!0},{default:n(()=>[We]),_:1})]),_:1},8,["modelValue"]),i(se,{modelValue:e.componentProps.localIsDynamicLoad,"onUpdate:modelValue":t[6]||(t[6]=d=>e.componentProps.localIsDynamicLoad=d),class:"fill-height"},{default:n(()=>[i(R,{value:!1,class:"fill-height",style:{"overflow-y":"auto"}},{default:n(()=>[i(o,{modelValue:e.componentProps[s.dataToUse],"onUpdate:modelValue":d=>e.componentProps[s.dataToUse]=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024),i(R,{value:!0,class:"fill-height pa-5",style:{"overflow-y":"auto"}},{default:n(()=>[i(k,{label:"URL",ref_for:!0,ref:"localDynamicLoadURL",modelValue:e.componentProps.localDynamicLoadURL,"onUpdate:modelValue":t[3]||(t[3]=d=>e.componentProps.localDynamicLoadURL=d),modelModifiers:{trim:!0},onKeyup:S(a.save,["enter"])},null,8,["modelValue","onKeyup"]),i(k,{label:"Key JSON Path",ref_for:!0,ref:"localDynamicLoadKeyJsonPath",modelValue:e.componentProps.localDynamicLoadKeyJsonPath,"onUpdate:modelValue":t[4]||(t[4]=d=>e.componentProps.localDynamicLoadKeyJsonPath=d),modelModifiers:{trim:!0},onKeyup:S(a.save,["enter"])},null,8,["modelValue","onKeyup"]),i(k,{label:"Value JSON Path",ref_for:!0,ref:"localDynamicLoadValueJsonPath",modelValue:e.componentProps.localDynamicLoadValueJsonPath,"onUpdate:modelValue":t[5]||(t[5]=d=>e.componentProps.localDynamicLoadValueJsonPath=d),modelModifiers:{trim:!0},onKeyup:S(a.save,["enter"])},null,8,["modelValue","onKeyup"])]),_:1})]),_:2},1032,["modelValue"])],64)):s.settingType==="checkbox"&&a.isShowCheck(s)?(f(),V(oe,{key:6,ref_for:!0,ref:s.dataToUse,label:s.settingLabel,modelValue:e.componentProps[s.dataToUse],"onUpdate:modelValue":d=>e.componentProps[s.dataToUse]=d,onKeyup:S(a.save,["enter"])},null,8,["label","modelValue","onUpdate:modelValue","onKeyup"])):K("",!0)],64))),128))]),_:1}),i(g,{onClick:a.save},{default:n(()=>[ze]),_:1},8,["onClick"])]),_:1}),i(L,{modelValue:e.isHelpDialogOpen,"onUpdate:modelValue":t[9]||(t[9]=s=>e.isHelpDialogOpen=s),"max-width":"600"},{default:n(()=>[i(P,null,{default:n(()=>[i(J,null,{default:n(()=>[i(x,null,{default:n(()=>[Ge]),_:1}),i(g,{icon:"",style:{position:"absolute",right:"5px",top:"5px"},onClick:t[7]||(t[7]=s=>e.isHelpDialogOpen=!1)},{default:n(()=>[i(U,null,{default:n(()=>[Ze]),_:1})]),_:1})]),_:1}),i(N,null,{default:n(()=>[Qe,Ye,Xe,et,tt,ot,at,it,nt,st,lt,rt]),_:1}),i(z,{style:{"justify-content":"right"}},{default:n(()=>[i(g,{onClick:t[8]||(t[8]=s=>e.isHelpDialogOpen=!1),class:"w-100"},{default:n(()=>[dt]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const ct=I(Re,[["render",ut],["__scopeId","data-v-079e7b84"]]);const mt={name:"container-setting-panel",emits:["onClose","onSave"],props:{sectionId:String,containerProps:Object},data:()=>({localContainerProps:null}),watch:{containerProps:{deep:!0,handler(e){this.localContainerProps={...e}}}},created(){this.localContainerProps={...this.containerProps}},methods:{save(){if(this.localContainerProps.isMultiDataMode&&(!this.localContainerProps.name||this.localContainerProps.name.length<=0)){alert("Name is required"),this.$refs.name.focus();return}this.$emit("onSave",this.sectionId,this.localContainerProps)}},mounted(){this.$nextTick(()=>{this.$refs.name.focus()})}},pt=p(" Edit Container Attribute "),ht=p("mdi-close"),ft=p(" Apply ");function vt(e,t,c,l,r,a){return f(),V(P,{class:"mx-auto my-8",elevation:"16","max-width":"600"},{default:n(()=>[i(J,null,{default:n(()=>[i(x,null,{default:n(()=>[pt]),_:1}),i(g,{icon:"",style:{position:"absolute",right:"5px",top:"5px"},onClick:t[0]||(t[0]=o=>e.$emit("onClose"))},{default:n(()=>[i(U,null,{default:n(()=>[ht]),_:1})]),_:1})]),_:1}),i(N,null,{default:n(()=>[i(k,{ref:"name",label:"Name",modelValue:e.localContainerProps.name,"onUpdate:modelValue":t[1]||(t[1]=o=>e.localContainerProps.name=o),modelModifiers:{trim:!0},onKeyup:S(a.save,["enter"]),"persistent-placeholder":""},null,8,["modelValue","onKeyup"]),i(k,{label:"Label",modelValue:e.localContainerProps.alias,"onUpdate:modelValue":t[2]||(t[2]=o=>e.localContainerProps.alias=o),modelModifiers:{trim:!0},onKeyup:S(a.save,["enter"]),"persistent-placeholder":""},null,8,["modelValue","onKeyup"]),i(oe,{label:"MultiDataMode",modelValue:e.localContainerProps.isMultiDataMode,"onUpdate:modelValue":t[3]||(t[3]=o=>e.localContainerProps.isMultiDataMode=o),onKeyup:S(a.save,["enter"])},null,8,["modelValue","onKeyup"])]),_:1}),i(g,{onClick:a.save},{default:n(()=>[ft]),_:1},8,["onClick"])]),_:1})}const yt=I(mt,[["render",vt],["__scopeId","data-v-5a4f57d0"]]),B={props:{content:{type:String,default:""},vueRenderUUID:{type:String,default:""}},setup(){const e=ge(null);return{componentRef:e,createComponentWithRef:(l,r)=>_e(l,{...r,ref:a=>{a&&(e.value=a)}}),parseContentToProps:l=>{const a=new DOMParser().parseFromString(l,"text/html").body.firstChild,o={};return a&&Array.from(a.attributes).forEach(s=>{o[s.name]=s.value}),o}}},render(){const c=new DOMParser().parseFromString(this.content,"text/html").body.firstChild.tagName.toLowerCase();switch(c){case"text-field":return this.createComponentWithRef(Ue,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"select-field":return this.createComponentWithRef(Me,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"checkbox-field":return this.createComponentWithRef(Ee,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"radio-field":return this.createComponentWithRef(De,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"file-field":return this.createComponentWithRef(Ve,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"label-field":return this.createComponentWithRef(ke,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"boolean-field":return this.createComponentWithRef(Ae,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"textarea-field":return this.createComponentWithRef(Te,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"user-select-field":return this.createComponentWithRef(we,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});case"code-field":return this.createComponentWithRef(Ce,{vueRenderUUID:this.vueRenderUUID,tagName:c,...this.parseContentToProps(this.content)});default:return console.error("유효하지 않은 렌더링 content:",this.content),""}}};const gt={name:"mash-up",mixins:[ne],components:{DynamicComponent:B,FormDefinitionPanel:ct,ContainerSettingPanel:yt},props:{modelValue:String},emits:["onChangeKEditorContent","onSaveFormDefinition","onInitKEditorContent"],expose:["getKEditorContentHtml","clearStat"],data:()=>({kEditor:null,kEditorContent:'<div id="kEditor1"></div>',componentRefForSetting:null,isOpenComponentSettingDialog:!1,isOpenContainerSettingDialog:!1,containerSectionId:"",containerProps:{name:"",alias:"",isMultiDataMode:!1}}),methods:{onchangeKEditor(e,t){window.mashup.kEditorContent=window.mashup.kEditor[0].children[0].innerHTML,console.log("[*] onchangeKEditor 이벤트 => ",t),window.mashup.$emit("onChangeKEditorContent",{kEditorContent:window.mashup.kEditorContent,html:window.mashup.kEditorContentToHtml(window.mashup.kEditor[0].children[0].innerHTML,!1)})},loadStylesForKEditor(){["/css/keditor.css","/css/keditor-component-text.css"].forEach(t=>{const c=document.createElement("link");c.rel="stylesheet",c.href=t,c.classList.add("keditor-stylesheet"),document.head.appendChild(c)})},removeStylesForKEditor(){document.querySelectorAll(".keditor-stylesheet").forEach(e=>{document.head.removeChild(e)})},clearStat(){window.mashup.kEditor[0].children[0].innerHTML="",window.mashup.kEditorContent="",window.mashup.$emit("onChangeKEditorContent",{kEditorContent:"",html:""})},getKEditorContentHtml(){return window.mashup.kEditorContentToHtml(window.mashup.kEditor[0].children[0].innerHTML)},kEditorContentToHtml(e,t=!0){let l=new DOMParser().parseFromString(e,"text/html");l.querySelectorAll("div[id^='vuemount_']").forEach(o=>{const s=o.id,u=window.mashup.componentRefs[s],d=document.createElement(u.tagName);u.settingInfos.forEach(m=>{m.settingType==="items"?d.setAttribute(m.htmlAttribute,JSON.stringify(u[m.dataToUse])):m.addOns&&m.addOns.includes("savedAsInnerText")?m.addOns.includes("encodedAsBase64")?d.innerText=decodeURIComponent(atob(u[m.dataToUse])):d.innerText=u[m.dataToUse]:d.setAttribute(m.htmlAttribute,u[m.dataToUse])}),o.innerHTML=d.outerHTML}),l.querySelectorAll("div.keditor-toolbar").forEach(o=>{o.remove()});const r=o=>{const s=o.parentElement;for(;o.firstChild;)s.insertBefore(o.firstChild,o);s.removeChild(o)},a=o=>{l.querySelectorAll(o).forEach(s=>{r(s)})};return a('[id^="vuemount_"]'),a("section.keditor-component-content"),a("section.keditor-initialized-component"),a("section.keditor-initializing-component"),a("section.keditor-container-inner:not(.keditor-container)"),l.querySelectorAll("section.keditor-initialized-container").forEach(o=>{o.removeAttribute("class"),o.removeAttribute("id")}),l.querySelectorAll('[class^="col-sm-"]').forEach(o=>{o.setAttribute("class",o.getAttribute("class").split(" ").filter(s=>s.includes("col-sm-")).join(" ")),o.removeAttribute("id"),o.removeAttribute("data-type")}),t?l.body.innerHTML.replace(/&quot;/g,"'").replace("<br>",`
`):l.body.firstChild.innerHTML.replace(/&quot;/g,"'").replace("<br>",`
`)},editFormDefinition(e,t){e.settingInfos.forEach(c=>{e[c.dataToUse]=t[c.dataToUse]}),window.mashup.isOpenComponentSettingDialog=!1},editContainerDefinition(e,t){console.log("[*] editContainerDefinition  : ",e,t);const c=$(`section#${e} .row`)[0];c.setAttribute("name",t.name),c.setAttribute("alias",t.alias),c.setAttribute("is_multidata_mode",String(t.isMultiDataMode)),window.mashup.isOpenContainerSettingDialog=!1},completeClearKEditor(){$("body").off("click",".btn-container-setting"),$("body").off("click",".btn-container-duplicate"),$("body").off("click",".btn-container-delete"),$("body").off("click",".btn-component-setting"),$("body").off("click",".btn-component-duplicate"),$("body").off("click",".btn-component-delete"),$("body").off("dblclick",".keditor-component"),document.body.classList.remove("initialized-click-event-handlers"),document.body.classList.remove("initialized-snippets-list"),$(".keditor-content-area").remove(),$(".keditor-ui").remove(),$("#kEditor1").data("keditor",null)},renderWithDynamicComponent(e,t,c=!1){const l=new DOMParser().parseFromString(e,"text/html");if(c)l.body.querySelectorAll("[name]").forEach(a=>a.setAttribute("name",a.getAttribute("name")+"-copy"));else{const a=Object.values(window.mashup.componentRefs).filter(o=>o.localName).length+1;l.body.querySelectorAll("[name]").forEach(o=>o.setAttribute("name",o.getAttribute("name")+`-${a}`))}const r=Z(B,{content:l.body.innerHTML,vueRenderUUID:t}).use(Q).mount("#"+t);window.mashup.componentRefs[t]=r.componentRef},getUserInputableComponentNames(){return Object.values(window.mashup.componentRefs).filter(e=>e.tagName.toLowerCase()!=="code-field"&&e.localName!==void 0&&e.localAlias!==void 0).map(e=>e.localName)}},mounted(){if(window.mashup=this,window.mashup.completeClearKEditor(),window.mashup.$route.path.includes("ui-definitions/")&&window.mashup.loadStylesForKEditor(),window.mashup.kEditor=$("#kEditor1"),window.mashup.modelValue&&($(window.mashup.kEditor)[0].innerHTML=window.mashup.modelValue),window.mashup.kEditor.keditor({tabContainersText:'<i class="fa fa-th-list"></i>',tabComponentsText:'<i class="fa fa-file"></i>',extraTabs:{setting:{text:'<i class="fa fa-cogs"></i>',title:"Settings",content:'<div class="form-horizontal">   <button class="btn btn-primary btn-lg" style="width:100%" id="clearBtn">Clear</button></div>'}},niceScrollEnabled:!1,tabTooltipEnabled:!1,snippetsTooltipEnabled:!1,containerSettingEnabled:!0,onInitSidebar:function(e){const t={"Content-type":"html; charset=UTF-8",Accept:"*/*"};be.get(`${window.location.origin}/snippets/default/snippets.html`,{headers:t}).then(function(c){console.log("axios result",c),e.renderSnippets(c.data),e.initSnippets(),e.initTabs(),e.initTabsSwitcher(),e.initSettingPanel(),e.options.snippetsFilterEnabled&&(e.initSnippetsFilter("Container"),e.initSnippetsFilter("Component")),(e.options.snippetsTooltipEnabled||e.options.tabTooltipEnabled)&&e.body.find("#"+e.options.snippetsListId).find('[data-toggle="tooltip"]').tooltip()})},containerSettingInitFunction:function(e,t){$("#clearBtn").on("click",function(c){window.mashup.clearStat()}),console.log("containerSettingInitFunction  : ",e,t),e.append('<div class="form-horizontal">   <h3>Here is Setting Container Panel!</h3></div>')},onContentChanged:function(e,t,c){$("#initGuide").css("opacity","0"),t&&c&&c.includes("vuemount_")&&window.mashup.renderWithDynamicComponent(t,c,!1),window.mashup.onchangeKEditor(e,"onContentChanged")},componentSettingShowFunction:function(e,t,c){console.log("componentSettingShowFunction : ",e,t,c);try{const l=new DOMParser().parseFromString(t[0].innerHTML,"text/html").querySelectorAll("div[id^='vuemount_']");if(l.length==0){alert("선택된 입력 요소가 없습니다.");return}const r=window.mashup.componentRefs[l[0].id];if(!r.settingInfos||r.settingInfos.length<=0){alert("해당 입력 요소에 대해서 추가적으로 세팅할 수 있는 항목이 없습니다.");return}r.settingInfos.forEach(a=>{a.addOns&&a.addOns.includes("inputableNameItems")&&(a.settingValue=window.mashup.getUserInputableComponentNames())}),window.mashup.componentRefForSetting=r,window.mashup.isOpenComponentSettingDialog=!0}catch(l){console.error(l)}},onInitComponent:function(e){if(window.mashup.onchangeKEditor(e,"onInitComponent"),e.hasClass("keditor-container"))e&&e.length>0&&e[0].setAttribute("id",`keditor-container-${new Date().getTime()}`);else if(e&&e.length>0&&e[0].querySelectorAll("div[id^='vuemount_']").length>0){const t=e[0].querySelectorAll("div[id^='vuemount_']")[0].getAttribute("id");if(t){const c=window.mashup.kEditor[0].children[0].querySelectorAll(`div[id='${t}']`);if(c.length==2){let l=window.mashup.kEditorContentToHtml(c[0].outerHTML,!1);const r=`vuemount_${crypto.randomUUID()}`;l=l.replace(t,r),e[0].querySelector(".keditor-component-content").innerHTML=l,window.mashup.renderWithDynamicComponent(new DOMParser().parseFromString(l,"text/html").body.firstChild.innerHTML,r,!0)}}}},onComponentChanged:function(e){window.mashup.onchangeKEditor(e,"onComponentChanged")},initContentAreas:function(e,t){console.log("initContentAreas",e,t)},componentSettingHideFunction:function(e,t){console.log("componentSettingHideFunction : ",e,t)},containerSettingShowFunction:function(e,t,c){console.log("containerSettingShowFunction : ",e,t,c);const l=new DOMParser().parseFromString(t[0].outerHTML,"text/html");window.mashup.containerSectionId=l.querySelector("section").id;const r=l.querySelector(".row");window.mashup.containerProps={name:r&&r.getAttribute("name")||"",alias:r&&r.getAttribute("alias")||"",isMultiDataMode:r?r.getAttribute("is_multidata_mode")==="true":!1},window.mashup.isOpenContainerSettingDialog=!0},containerSettingHideFunction:function(e,t){console.log("containerSettingHideFunction : ",e,t)},onReady:function(){$("#keditor-setting-panel").remove()}}),window.mashup.componentRefs={},window.mashup.modelValue){$("#initGuide").css("opacity","0");const t=new DOMParser().parseFromString(window.mashup.modelValue,"text/html");t.querySelectorAll("code-field").forEach(l=>{const r=l.innerText,a=btoa(encodeURIComponent(r));l.setAttribute("encoded_code",a),l.innerText=""}),t.querySelectorAll("div[id^='vuemount_']").forEach(l=>{try{const r=l.id,a=Z(B,{content:l.innerHTML,vueRenderUUID:r}).use(Q).mount("#"+r);window.mashup.componentRefs[r]=a.componentRef}catch(r){console.log("### KEditor에서 Vue 컴포넌트 렌더링시에 오류 발생 ! ###"),console.log("window.mashup.modelValue: ",window.mashup.modelValue),console.log("vueRenderElement: ",l),console.error(r)}})}window.mashup.kEditorContent=window.mashup.kEditor[0].children[0].innerHTML,window.mashup.$emit("onInitKEditorContent",window.mashup.getKEditorContentHtml())},beforeUnmount(){window.mashup.removeStylesForKEditor(),window.mashup.completeClearKEditor()}},le=e=>(ae("data-v-78bb7393"),e=e(),ie(),e),_t=le(()=>v("div",{id:"initGuide"},[v("span",{style:{"font-size":"18px","font-weight":"bold"}}," 여기에 레이아웃(Container)을 드래그해서 폼 편집을 시작하십시오. ")],-1)),bt=le(()=>v("div",{id:"kEditor1",style:{position:"relative",top:"-135px"}},null,-1));function St(e,t,c,l,r,a){const o=A("form-definition-panel"),s=A("container-setting-panel");return f(),b("div",null,[_t,bt,i(L,{modelValue:e.isOpenComponentSettingDialog,"onUpdate:modelValue":t[1]||(t[1]=u=>e.isOpenComponentSettingDialog=u)},{default:n(()=>[i(o,{componentRef:e.componentRefForSetting,onOnSave:a.editFormDefinition,onOnClose:t[0]||(t[0]=u=>e.isOpenComponentSettingDialog=!1)},null,8,["componentRef","onOnSave"])]),_:1},8,["modelValue"]),i(L,{modelValue:e.isOpenContainerSettingDialog,"onUpdate:modelValue":t[3]||(t[3]=u=>e.isOpenContainerSettingDialog=u)},{default:n(()=>[i(s,{sectionId:e.containerSectionId,containerProps:e.containerProps,onOnSave:a.editContainerDefinition,onOnClose:t[2]||(t[2]=u=>e.isOpenContainerSettingDialog=!1)},null,8,["sectionId","containerProps","onOnSave"])]),_:1},8,["modelValue"])])}const Ct=I(gt,[["render",St],["__scopeId","data-v-78bb7393"]]),wt={name:"FormDesignSavePanel",emits:["onClose","onSave"],props:{savedId:String,formNameByUrl:String},data:()=>({infoToSave:{id:""},placeholder:{id:""},default:{id:`untitled/${Date.now()}`},regexStr:/^[가-힣a-zA-Z0-9_\-. \/]+$/,regexErrorMsg:"'{{propName}}'은 한글, 영문, 숫자, 공백, 밑줄(_), 대시(-), 점(.), 슬래시(/)만 입력 가능합니다!"}),methods:{save(){if((!this.infoToSave.id||this.infoToSave.id.length<=0)&&(this.infoToSave.id=this.default.id),!this.regexStr.test(this.infoToSave.id)){alert(this.regexErrorMsg.replace("{{propName}}","ID")),this.$refs.inputId.focus();return}this.$emit("onSave",this.infoToSave)}},created(){this.placeholder.id=this.default.id,this.savedId&&(this.infoToSave.id=this.savedId),this.formNameByUrl&&this.formNameByUrl.length>0&&(this.infoToSave.id=this.formNameByUrl)},mounted(){this.savedId?this.$nextTick(()=>{this.$refs.saveButton.$el.focus()}):this.$nextTick(()=>{this.$refs.inputId.focus()})}},Tt=p("mdi-close"),At=p(" SAVE ");function kt(e,t,c,l,r,a){return f(),V(P,{class:"mx-auto my-8",elevation:"16","max-width":"400"},{default:n(()=>[i(x,{class:"ma-0 pa-0",style:{padding:"15px 0px 0px 25px !important"}},{default:n(()=>[p(w(c.savedId?"UpdateForm":"NewForm"),1)]),_:1}),i(g,{icon:"",style:{position:"absolute",right:"5px",top:"5px"},onClick:t[0]||(t[0]=o=>e.$emit("onClose"))},{default:n(()=>[i(U,null,{default:n(()=>[Tt]),_:1})]),_:1}),i(N,null,{default:n(()=>[i(C,null,{default:n(()=>[i(k,{ref:"inputId",modelValue:e.infoToSave.id,"onUpdate:modelValue":t[1]||(t[1]=o=>e.infoToSave.id=o),modelModifiers:{trim:!0},label:"ID",onKeyup:S(a.save,["enter"]),placeholder:e.placeholder.id,"persistent-placeholder":"",disabled:!!c.savedId},null,8,["modelValue","onKeyup","placeholder","disabled"])]),_:1})]),_:1}),i(z,{style:{"justify-content":"right"}},{default:n(()=>[i(g,{ref:"saveButton",onClick:a.save,onKeyup:S(a.save,["enter"])},{default:n(()=>[At]),_:1},8,["onClick","onKeyup"])]),_:1})]),_:1})}const Vt=I(wt,[["render",kt]]),F={containerSpaceSets:[[12],[6,6],[4,8],[8,4],[4,4,4],[3,6,3],[3,3,3,3]],componentInfos:[{tag:"<text-field name='<이 입력창의 고유한 이름>' alias='<이 입력창의 별명>' type='<text|number|email|url|date|datetime-local|month|week|time|password|tel|color>' disabled='<true|false>'></text-field>",purpose:"다양한 유형의 텍스트를 입력받기 위해서",limit:"년도와 같이 선택해야 할 항목이 너무 많은 경우에는 text-field를 사용할 것"},{tag:"<textarea-field name='<이 입력창의 고유한 이름>' alias='<이 입력창의 별명>' rows='<입력창의 행 크기>' disabled='<true|false>'></textarea-field>",purpose:"여러 행에 걸쳐서 텍스트를 입력받기 위해서",limit:""},{tag:"<boolean-field name='<이 입력창의 고유한 이름>' alias='<이 입력창의 별명>' disabled='<true|false>'></boolean-field>",purpose:"'true' 또는 'false' 중 하나를 선택하기 위해서",limit:""},{tag:"<select-field name='<이 선택창의 고유한 이름>' alias='<이 선택창의 별명>' is_dynamic_load='<true|false>' items='<is_dynamic_load가 false시에 선택 항목 리스트>' dynamic_load_url='<is_dynamic_load가 true시에 JSON 데이터 로드 URL>' dynamic_load_key_json_path='<is_dynamic_load가 true시에 키 배열을 담을 JSON PATH>' dynamic_load_value_json_path='<is_dynamic_load가 true시에 값 배열을 담을 JSON PATH>' disabled='<true|false>'></select-field>",purpose:"여러개의 옵션 중 하나를 선택하기 위해서",limit:`is_dynamic_load가 false인 경우, 선택 항목 리스트를 만들기 위해서 items 필수 작성.items는 '[{"key1": "label1"}, {"key2": "label2"}]'와 같이 작성되어야 함.is_dynamic_load가 true인 경우, dynamic_load_url, dynamic_load_key_json_path, dynamic_load_value_json_path 필수 작성.`},{tag:"<checkbox-field name='<이 선택창의 고유한 이름>' alias='<이 선택창의 별명>' is_dynamic_load='<true|false>' items='<is_dynamic_load가 false시에 선택 항목 리스트>' dynamic_load_url='<is_dynamic_load가 true시에 JSON 데이터 로드 URL>' dynamic_load_key_json_path='<is_dynamic_load가 true시에 키 배열을 담을 JSON PATH>' dynamic_load_value_json_path='<is_dynamic_load가 true시에 값 배열을 담을 JSON PATH>' disabled='<true|false>'></checkbox-field>",purpose:"여러개의 선택 사항들 중, 여러개를 선택하기 위해서",limit:`is_dynamic_load가 false인 경우, 선택 항목 리스트를 만들기 위해서 items 필수 작성.items는 '[{"key1": "label1"}, {"key2": "label2"}]'와 같이 작성되어야 함.is_dynamic_load가 true인 경우, dynamic_load_url, dynamic_load_key_json_path, dynamic_load_value_json_path 필수 작성.`},{tag:"<radio-field name='<이 선택창의 고유한 이름>' alias='<이 선택창의 별명>' is_dynamic_load='<true|false>' items='<is_dynamic_load가 false시에 선택 항목 리스트>' dynamic_load_url='<is_dynamic_load가 true시에 JSON 데이터 로드 URL>' dynamic_load_key_json_path='<is_dynamic_load가 true시에 키 배열을 담을 JSON PATH>' dynamic_load_value_json_path='<is_dynamic_load가 true시에 값 배열을 담을 JSON PATH>' disabled='<true|false>'></radio-field>",purpose:"나열된 여러개의 옵션 중 하나를 선택하기 위해서",limit:`is_dynamic_load가 false인 경우, 선택 항목 리스트를 만들기 위해서 items 필수 작성.items는 '[{"key1": "label1"}, {"key2": "label2"}]'와 같이 작성되어야 함.is_dynamic_load가 true인 경우, dynamic_load_url, dynamic_load_key_json_path, dynamic_load_value_json_path 필수 작성.`},{tag:"<user-select-field name='<이 선택창의 고유한 이름>' alias='<이 선택창의 별명>' disabled='<true|false>'></user-select-field>",purpose:"유저들을 선택하기 위해서",limit:""},{tag:"<file-field name='<이 선택창의 고유한 이름>' alias='<이 선택창의 별명>' disabled='<true|false>'></file-field>",purpose:"파일을 입력받기 위해서",limit:""},{tag:"<label-field label='<입력시킬 라벨 값>'></label-field>",purpose:"특정 컴포넌트를 설명하기 위해서",limit:"name, alias가 있는 경우에는 이미 내부적으로 label이 설정되기 때문에 쓸 필요가 없음"},{tag:"<code-field name='<이 코드의 고유한 이름>' alias='<이 코드의 별명>' event_type='<click|initialize|validate|watch>' watch_name='<event_type이 watch인 경우, 감시할 name 속성>'>실행시킬 Javascript 코드</code-field>",purpose:"지정된 이벤트가 발생하면 코드를 실행하기 위해서",limit:`code-field 또한 반드시 'col-sm-*' 속성으로 선언된 div 안에 속해야 함.

                    또한, code-field가 속한 row의 is_multidata_mode는 반드시 false여야 함.

                    세부 메뉴얼은 다음과 같음.

                   * event_type에 따라서 코드를 실행하는 방식이 달라짐
click인 경우, 버튼을 누를 경우, 주어진 코드가 실행됨
initialize인 경우, 맨 처음 폼이 표시될때 주어진 코드가 실행됨
validate인 경우, 폼을 제출할시에 주어진 코드가 실행됨
watch인 경우, watch_name 속성에 정의된 값이 변경될 경우, 주어진 코드가 실행됨
* 코드 작성 규칙은 다음과 같음
1. 각각의 코드 작성 줄이 끝나면 ';'를 붙여야 함
2. 주어진 코드가 실행되기 위해서는 반드시 자바스크립트 코드를 사용해야 함
3. 현재 유저가 입력한 값은 this.formValues[<name 속성>]에 저장되어 있음
4. event_type이 watch인 경우, this.oldFormValues[<name 속성>]에 이전 값이 저장되어 있음
5. event_type이 validate인 경우, 에러가 있을 경우, error 속성에 에러메시지를 저장하고, 없을 경우 아무것도 하지 않으면 됨`}],examples:[{input:"도서 정보 입력 폼을 생성해줘. 책 제목이 입력되었는지 제출시 검사하도록 만들어줘. 그리고, 책 표지 이미지를 입력받을때는 여러개를 입력받을 수 있도록 해줘.",output:`
            \`\`\`
            {
                "htmlOutput": 
                "<section>
                    <div class='row' name='book_info' alias='도서 정보' is_multidata_mode='false'>
                        <div class='col-sm-12'>
                            <text-field name='book_title' alias='책 제목'></text-field>
                            <text-field name='book_author' alias='저자'></text-field>
                            <text-field name='book_price' alias='가격' type='number'></text-field>
                            <text-field name='book_publish_date' alias='발행날짜' type='date'></text-field>
                            <select-field name='book_genre' alias='책 장르' is_dynamic_load='false' items='[{"novel": "소설"}, {"poem": "시"}, {"essay": "에세이"}, {"SF": "공상 과학"}]'></select-field>
                                             
                            <section>
                                <div class='row' name='book_cover_images' alias='책 표지 이미지 목록' is_multidata_mode='true'>
                                    <div class='col-sm-12'>
                                        <file-field name='book_cover_image' alias='책 표지 이미지'></file-field>
                                    </div>
                                </div>
                            </section>
                        </div>
                    </div>
                </section>
                <section>
                    <div class='row' name='code' alias='코드' is_multidata_mode='false'>
                        <div class='col-sm-12'>
                            <code-field name="checkBookTitle" alias="책 제목 검사" event_type="validate">
                            if(this.formValues["book_title"] === "") error = "책 제목은 반드시 입력해야 합니다."
                            </code-field>  
                        </div>
                    </div>
                </section>
                "
            }
            \`\`\``},{input:"도서 정보 입력 폼에서 책 장르에 '공상 과학' 항목을 추가해줘",output:`
            \`\`\`
            {
                "modifications":[
                {
                    "action": "replace",
                    "targetCSSSelector": "select-field[name='book_genre']",
                    "tagValue": "<select-field name='book_genre' alias='책 장르' is_dynamic_load='false' items='[{"novel": "소설"}, {"poem": "시"}, {"essay": "에세이"}, {"SF": "공상 과학"}]'></select-field>"
                }
                ]
            }
            \`\`\``}]};class X extends Se{constructor(t,c){super(t,c),this.avaliableComponentTagNames=F.componentInfos.map(o=>o.tag.match(/\<\/(.*)\>/)[1].toLowerCase());const l=F.containerSpaceSets.map(o=>"{"+o.join(", ")+"}").join(", "),r="["+F.componentInfos.map(o=>`{태그: '${o.tag}', 목적: ${o.purpose}${o.limit?`, 주의사항: ${o.limit}`:""}}`).join(",")+"]",a=F.examples&&F.examples.length>0?`* 예시
`+F.examples.map(o=>`- 입력: ${o.input}
- 출력: ${o.output}`).join(`
`):"";this.prevMessageFormat={role:"system",content:`
          너는 프로세스를 진행하기 위한 HTML 폼을 만들어주는 도우미야.
          단, 너는 주어진 메뉴얼에 있는 태그만을 활용해서 폼을 만들어야 해.

          메뉴얼:
          - 처음으로 폼 생성
          이미 만들어진 폼에 관련된 정보가 없을 경우에는 다음과 같은 지시에 따라서 반환해야 해.

          * 레이아웃 구성
          맨 처음에는 각 컴포넌트를 넣기 위한 레이아웃을 만들어줘야 해.
          레이아웃의 구성 예는 다음과 같아.
          """
          <section>
            <div class='row' name='<이 레이아웃의 고유한 이름>' alias='<이 레이아웃의 별명>' is_multidata_mode='<true|false>'>
                <div class='col-sm-6'>
                </div>
                <div class='col-sm-6'>
                </div>
            </div>
          </section>
          """
          다음과 같이 section으로 감싸진 "class='row'"가 선언된 div안에 "class='col-sm-{숫자}'"로 지정된 div들을 생성해서 각 칼럼이 차지하는 공간을 각각 만들어주면 돼.
          하나의 section은 자식 요소로 하나의 "class='row'"가 선언된 div를 가질 수 있음에 주의해야해.
          하나의 "class='row'"가 선언된 div안에 들어가는 "class='col-sm-{숫자}'"에서 '{숫자}'의 총합은 12가 되어야 하고, 반드시 아래에 제시되는 숫자 조합 중에 하나를 사용해야 해.
          > 허용되는 숫자 조합: ${l}

          class='row'로 선언된 div 안에는 name, alias 이외에도 is_multidata_mode 속성을 설정할 수 있어.
          is_multidata_mode이 true인 경우에는 내부에서 사용되는 컴포넌트들을 사용해서 마치 테이블의 행을 추가하는 것 처럼 사용할 수 있어.
          is_multidata_mode이 false인 경우에는 일반적인 레이아웃과 동일하게 동작해.

          레이아웃은 중첩해서도 사용할 수 있어.
          중첩해서 사용할 경우에는 반드시 'col-sm-{숫자}'로 지정된 div안에 이전과 같이 section 태그를 사용해서 넣어줘야 해.
          예를 들어 다음과 같이 이중으로 레이아웃을 중첩시킬 수 있어.
          """
          <section>
            <div class='row' name='<이 레이아웃의 고유한 이름>' alias='<이 레이아웃의 별명>' is_multidata_mode='<true|false>'>
              <div class='col-sm-12'>
                <section>
                  <div class='row' name='<이 레이아웃의 고유한 이름>' alias='<이 레이아웃의 별명>' is_multidata_mode='<true|false>'>
                    <div class='col-sm-6'>
                    </div>
                    <div class='col-sm-6'>
                    </div>
                  </div>
                </section>
              </div>
            </div>
          </section>
          """

          * 컴포넌트 추가
          레이아웃을 만들었다면, 이제 각 컴포넌트를 추가해 줘야 해.
          컴포넌트에는 다음과 같은 주의 사항이 있어.
          1. 만약에 태그의 속성이 "<>"로 감싸져 있다면, 너는 그 속성을 "<>"에 적혀있는 지시를 따라서 교체해 줘야 해.
          2. 만약에 태그의 속성이 "<>"로 감싸져 있지 않다면, 너는 그것이 상수라고 생각하고 그 속성을 그대로 적어줘야 해.
          3. "<>" 안에 값이 '|'로 나열된 경우, 너는 그 값 중 하나를 선택해서 적어줘야 해.(예 : "<값1>|<값2>|<값3>")
          4. 배열이 아닌 문자열이 태그의 속성에 들어가는 경우, 값은 한글, 숫자, 영문자, 공백, 밑줄(_), 대시(-), 점(.)만 가능해.
          5. items과 같은 배열인 문자열이 들어가는 경우에는 각각의 키와 값이 한글, 숫자, 영문자, 공백, 밑줄(_), 대시(-), 점(.)만 가능해.
          6. items과 같은 배열에 '...'과 같이 나열하는 문자는 쓸 수 없어. 나열해야 할 정도로 긴 경우에는 그냥 text-field 태그를 써줘.
          7. items에 들어가는 각각의 키는 고유해야 해. 즉, 중복된 키가 존재하면 안돼.
          8. 모든 컴포넌트는 반드시 'col-sm-{숫자}'로 지정된 div 안에 들어가야 해.
          9. 여기서 제시한 태그의 속성만을 적어야 하고, 반드시 전부 다 적어줘야 해.

          사용해야 하는 컴포넌트는 다음과 같아.
          ${r}

          응답 시에는 절차나 과정 같은 것은 따로 설명하지 말고, 바로 JSON 응답만 출력하도록 하면 돼.
          JSON 응답은 markdown 으로, three backticks 로 감싸줘야 내가 이 결과를 사용해야 한다는 걸 알 수 있으니까 명심해.
          \`\`\`
          {
            "htmlOutput": "생성된 폼 HTML 코드"
          }
          \`\`\`
          
          - 기존의 폼 변경
          이미 만들어진 폼이 있는 경우에는 변경을 하기위한 지시사항들을 생성해줘야 해.
          변경인 경우도 변경된 최종 결과가 '처음으로 폼 생성'에서 했던 주의 사항을 지켜줘야 한다는 점을 명심해야 해.

          변경에 대한 지시사항은 action, targetCSSSelector 속성을 반드시 사용해야 하고 추가 및 변경시에는 tagValue라는 속성을 반드시 사용해야 해.
          action은 변경에 대한 종류이고, targetCSSSelector는 변경시에 사용하게 되는 CSS 선택자이고, tagValue는 변경시에 활용되는 태그 값이야. 삭제시에는 사용하지 않아도 돼.
          targetValue에는 하나의 태그 값만 넣을 수 있어. 여러개의 태그를 활용하고 싶을 경우에는 각 태그에 대해서 지시사항을 여러개 생성해주면 돼.

          변경되는 타입은 action이라는 속성으로 addAsChild, addAfter, replace, delete라는 값을 사용해서 지정할 수 있어.
          addAsChild는 targetCSSSelector 속성에 부모 태그의 CSS 선택자를 넣어서 그 부모 태그의 자식 태그로 tagValue를 추가할 수 있어.
          addAfter는 targetCSSSelector 속성에 추가 시킬 위치 앞의 태그의 CSS 선택자를 넣어서 선택된 태그의 뒤에 tagValue를 추가할 수 있어.
          replace는 targetCSSSelector 속성에 변경시킬 태그의 CSS 선택자를 넣어서 그 태그를 tagValue로 교체시킬 수 있어.
          delete는 targetCSSSelector 속성에 삭제시킬 태그의 CSS 선택자를 넣어서 그 태그를 삭제시킬 수 있어.

          응답 시에는 절차나 과정 같은 것은 따로 설명하지 말고, 바로 JSON 응답만 출력하도록 하면 돼.
          JSON 응답은 markdown 으로, three backticks 로 감싸줘야 내가 이 결과를 사용해야 한다는 걸 알 수 있으니까 명심해.
          \`\`\`
          {
            "modifications":[
              {
                "action": "addAsChild" | "addAfter" | "replace" | "delete",
                "targetCSSSelector": "CSS 선택자",
                "tagValue": "하나의 단일 HTML 태그 값"
              }
            ]
          }
          \`\`\`

          {{prevMessageFormat}}

          ${a}
`}}sendMessageWithPrevFormOutput(t){const c=this.client.prevFormOutput!=="<section></section>"?`이전에 만들어진 폼이 있고, 현재 수정하려고 해.
            따라서, '기존의 폼 변경' 가이드를 활용해서 수정과 관련된 JSON 객체를 반환시켜줘.
            이 폼은 무조건 최신 결과라고 생각하면 돼.
            이 이후의 채팅과 관계없이 해당 폼 HTML을 기준으로 작업해줘.
            이전에 만들어진 폼은 다음과 같아.
\`\`\``+this.client.prevFormOutput+"```":"",l={...this.prevMessageFormat};l.content=l.content.replace("{{prevMessageFormat}}",c),this.previousMessages=[l],console.log("### 전달되는 시스템상 AI 메시지 ###"),console.log(this.previousMessages),this.client.sendMessage(t)}createMessages(){let t=super.createMessages();return t[t.length-1].content=`- 입력: ${t[t.length-1].content}
- 출력: `,[t[0],t[t.length-1]]}createPrompt(){return this.client.newMessage}}ue({objectHash:function(e,t){return"$$index:"+t}});const Dt={mixins:[ne],name:"UIDefinitionChat",components:{Chat:$e,AppBaseCard:Pe,ChatListing:me,ChatDetail:ce,ChatProfile:pe,Mashup:Ct,ChatGenerator:X,FormDesignSavePanel:Vt,DynamicForm:Fe},data:()=>({path:"form_def",chatInfo:{title:"uiDefinition.cardTitle",text:"uiDefinition.uiDefinitionExplanation"},kEditorInput:"",mashupKey:0,prevFormOutput:"",prevMessageFormat:"",storedFormDefHTML:"",isOpenSaveDialog:!1,currentTabName:"",isShowMashup:!1,previewHTML:"",previewFormValues:{},isShowPreview:!1,dev:{isDevMode:window.localStorage.getItem("isDevMode")==="true",previewFormValues:""},loadFormId:"",isLoadedForm:!1,kEditorContentBeforeSave:"",isAIUpdated:!1,isRoutedWithUnsaved:!1,processDefUrlData:null,formNameByUrl:null,isOpenDeleteDialog:!1}),async created(){this.generator=new X(this,{isStream:!0,preferredLanguage:"Korean"}),await this.init();const t=new URLSearchParams(window.location.search).get("process_def_url_data");t&&(this.processDefUrlData=JSON.parse(decodeURIComponent(atob(t))),this.beforeSendMessage({image:null,text:this.processDefUrlData.initPrompt,mentionedUsers:[]}),this.formNameByUrl=this.processDefUrlData.formName)},watch:{$route:{deep:!0,handler(e,t){if(e.path.startsWith("/ui-definitions")){if(this.isRoutedWithUnsaved){this.isRoutedWithUnsaved=!1;return}e.path!==t.path?this.$refs.mashup?this.isAIUpdated||this.$refs.mashup.getKEditorContentHtml()!=this.kEditorContentBeforeSave?window.confirm("You have unsaved changes. Are you sure you want to leave?")?this.loadData():(this.isRoutedWithUnsaved=!0,this.$router.push(t.path)):this.loadData():this.loadData():this.isShowMashup=!0}}},currentTabName:{handler(){this.currentTabName==="edit"?$("div[id^='keditor-content-area-']").css("display","block"):($("div[id^='keditor-content-area-']").css("display","none"),this.applyToPreviewTab())}}},methods:{updateKEditorContentBeforeSave(e){this.kEditorContentBeforeSave=e},openSaveDialog(){this.isOpenSaveDialog=!0},openDeleteDialog(){this.isOpenDeleteDialog=!0},async tryToSaveFormDefinition({id:e}){var t=this;t.$try({context:t,action:async()=>{const c=t.$refs.mashup.getKEditorContentHtml(),l=t.keditorContentHTMLToDynamicFormHTML(c);await t.saveFormDefinition({id:e,html:l})},successMsg:"저장되었습니다."})},keditorContentHTMLToDynamicFormHTML(e){const t=new DOMParser().parseFromString(e,"text/html"),c=new Set;t.querySelectorAll("[name]").forEach(r=>{const a=r.getAttribute("name");if(!(!a||a.length<=0)){if(c.has(a))throw new Error(`'${a}' 이름이 중복되어 있습니다.`);c.add(a)}});const l=t.querySelectorAll("div.row");for(let r=0;r<l.length;r++){const a=l[r];if(a.getAttribute("is_multidata_mode")==="true"&&a.querySelector("code-field"))throw new Error("multidataMode가 설정된 레이아웃 안에 code-field가 존재할 수 없습니다.")}return l.forEach(r=>{const a=r.getAttribute("is_multidata_mode");if(!a||a==="false"){const o=document.createElement("row-layout");o.setAttribute("name",r.getAttribute("name")??""),o.setAttribute("alias",r.getAttribute("alias")??""),o.setAttribute("is_multidata_mode",r.getAttribute("is_multidata_mode")??"false"),o.setAttribute("v-model","formValues"),o.setAttribute("v-slot","slotProps");const s=document.createElement("div");s.setAttribute("class","row"),Array.from(r.children).forEach(u=>{s.appendChild(u)}),$(s).children('[class^="col-sm-"]').children("[name]").each(function(){var u=$(this)[0];if(u.tagName.toLowerCase()==="code-field"){const d=u.getAttribute("name");u.setAttribute("v-model",`codeInfos['${d}']`),u.getAttribute("event_type")==="click"&&u.setAttribute("v-on:on_click",`executeCode('${d}')`)}else{const d=u.getAttribute("name");u.setAttribute("v-model",`slotProps.modelValue['${d}']`)}}),o.appendChild(s),r.parentNode.replaceChild(o,r)}else{if(!r.getAttribute("name")||r.getAttribute("name").length<=0)throw new Error("multidataMode가 설정된 레이아웃에 'name' 속성이 없습니다.");let o=!1,s=r.parentNode;for(;s&&s.tagName.toLowerCase()!=="body";){if(s.getAttribute("is_multidata_mode")==="true"){o=!0;break}s=s.parentNode}const u=document.createElement("row-layout");u.setAttribute("name",r.getAttribute("name")),u.setAttribute("alias",r.getAttribute("alias")??""),u.setAttribute("is_multidata_mode",r.getAttribute("is_multidata_mode")),u.setAttribute("v-model",o?"item":"formValues"),u.setAttribute("v-slot","slotProps");const d=document.createElement("div");d.setAttribute("v-for","(item, index) in slotProps.modelValue"),d.setAttribute(":key","index");const m=document.createElement("row-layout-item-head");m.setAttribute(":index","index"),m.setAttribute("v-on:on_delete_item","slotProps.deleteItem(index)"),d.appendChild(m);const _=document.createElement("div");_.classList.add("row"),Array.from(r.children).forEach(y=>{_.appendChild(y)}),d.appendChild(_),u.appendChild(d),$(u).children("div").children("div.row").children('[class^="col-sm-"]').children("[name]").each(function(){var y=$(this)[0];const h=y.getAttribute("name");y.setAttribute("v-model",`item['${h}']`)}),r.parentNode.replaceChild(u,r)}}),t.body.innerHTML.replace(/&quot;/g,"'").replace("<br>",`
`)},dynamicFormHTMLToKeditorContentHTML(e){const t=new DOMParser().parseFromString(e,"text/html");return t.querySelectorAll("row-layout").forEach(l=>{const r=l.getAttribute("is_multidata_mode");if(!r||r==="false"){const a=document.createElement("div");a.setAttribute("name",l.getAttribute("name")??""),a.setAttribute("alias",l.getAttribute("alias")??""),a.setAttribute("is_multidata_mode",l.getAttribute("is_multidata_mode")??"false"),a.setAttribute("class","row"),Array.from(l.firstChild.children).forEach(o=>{a.appendChild(o)}),$(a).children('[class^="col-sm-"]').children("[v-model]").each(function(){var o=$(this)[0];o.removeAttribute("v-model")}),$(a).children('[class^="col-sm-"]').children("*").each(function(){var o=$(this)[0];Array.from(o.attributes).forEach(s=>{s.name.startsWith("v-on:")&&o.removeAttribute(s.name)})}),l.parentNode.replaceChild(a,l)}else{const a=document.createElement("div");a.setAttribute("name",l.getAttribute("name")??""),a.setAttribute("alias",l.getAttribute("alias")??""),a.setAttribute("is_multidata_mode",l.getAttribute("is_multidata_mode")??"false"),a.setAttribute("class","row"),$(l).children("div").children("div.row").children('[class^="col-sm-"]').each(function(){var o=$(this)[0];a.appendChild(o)}),$(a).children('[class^="col-sm-"]').children("[v-model]").each(function(){var o=$(this)[0];o.removeAttribute("v-model")}),$(a).children('[class^="col-sm-"]').children("*").each(function(){var o=$(this)[0];Array.from(o.attributes).forEach(s=>{s.name.startsWith("v-on:")&&o.removeAttribute(s.name)})}),l.parentNode.replaceChild(a,l)}}),t.body.innerHTML.replace(/&quot;/g,"'").replace("<br>",`
`)},async saveFormDefinition({id:e,html:t}){const c=this.loadFormId!==e;if(c)try{if(await this.backend.getRawDefinition(e,{type:"form"})&&!confirm(`'${e}'는 이미 존재하는 폼 디자인 ID 입니다! 그래도 저장하시겠습니까?`))return}catch{}await this.backend.putRawDefinition(t,e,{type:"form"}),this.isOpenSaveDialog=!1,this.kEditorContentBeforeSave=this.$refs.mashup.getKEditorContentHtml(),this.isAIUpdated=!1,c&&(await this.$router.push(`/ui-definitions/${e}`),window.location.reload()),this.processDefUrlData&&(new BroadcastChannel(this.processDefUrlData.channelId).postMessage({name:this.processDefUrlData.formName,id:e}),window.close())},onClickPreviewSubmitButton(){const e=this.$refs.dynamicForm.validate();e&&e.length>0&&alert(e),this.dev.isDevMode?this.dev.previewFormValues=JSON.stringify(this.previewFormValues):alert(JSON.stringify(this.previewFormValues))},onClickPreviewApplyButton(){this.previewFormValues=JSON.parse(this.dev.previewFormValues)},async loadData(e){if(this.loadFormId=this.$route.params.pathMatch.join("/"),this.loadFormId.startsWith("/")&&(this.loadFormId=this.loadFormId.substring(1)),this.isLoadedForm=this.loadFormId&&this.loadFormId!="chat",this.isAIUpdated=!1,this.messages=[],this.isLoadedForm){try{this.storedFormDefHTML=await this.backend.getRawDefinition(this.loadFormId,{type:"form"})}catch{alert(`'${this.loadFormId}' ID 를 가지는 폼 디자인 정보가 없습니다! 새 폼 만들기 화면으로 이동됩니다.`),this.$router.push("/ui-definitions/chat"),this.isShowMashup=!0;return}const t=this.dynamicFormHTMLToKeditorContentHTML(this.storedFormDefHTML),c=this.loadHTMLToKEditorContent(t);this.applyNewSrcToMashup(c),this.isShowMashup=!0}else this.$refs.mashup&&this.$refs.mashup.clearStat(),this.isShowMashup=!0},beforeSendMessage(e){this.prevFormOutput=this.$refs.mashup.getKEditorContentHtml(),e.mentionedUsers=null,this.generator.sendMessageWithPrevFormOutput(e)},async afterModelCreated(e){this.processResponse(e)},afterGenerationFinished(e){this.processResponse(e)},processResponse(e){try{let t=this.messages[this.messages.length-1];if(t.jsonContent=this.extractLastJSON(e),t.content=t.content.replace(t.jsonContent,""),t.content.length==0&&(t.content=" "),t.jsonContent){if(t.jsonContent.htmlOutput)this.applyNewSrcToMashup(this.loadHTMLToKEditorContent(t.jsonContent.htmlOutput));else if(t.jsonContent.modifications){const c=this.getModifiedPrevFormOutput(t.jsonContent.modifications);this.applyNewSrcToMashup(this.loadHTMLToKEditorContent(c))}else console.error("알 수 없는 JSON 결과: ",JSON.stringify(t.jsonContent));this.isAIUpdated=!0}}catch(t){console.log(t)}},afterModelStopped(e){console.log(e)},extractLastJSON(e){const t=e.split("```");for(let c=t.length-1;c>=0;c--){const l=t[c];if(!l.includes("{")||!l.includes("}")||!l.includes("htmlOutput")&&!l.includes("modifications"))continue;const r=l.includes("htmlOutput");let a="";try{const o=l.match(/\{[\s\S]*\}/)[0].replaceAll(`
`,"").replaceAll("`",'"');if(r){const d=o.match(/"htmlOutput"\s*:\s*"(.*)".*}/)[1];d.includes('\\"')?a=o:a=o.replace(d,d.replaceAll('"','\\"'))}else{const d=[...o.matchAll(/items='\[(.*?)\]'>/g)].map(m=>m[1]);if(a=o,d)for(let m=0;m<d.length;m++){const _=d[m];_.includes('\\"')||(a=a.replace(_,_.replaceAll('"','\\"')))}}const s=[...a.matchAll(/items='\[(.*?)\]'>/g)].map(d=>d[1]);if(s)for(let d=0;d<s.length;d++){const m=s[d];m.includes("'")&&(a=a.replace(m,m.replaceAll("'",'\\"')))}const u=[...a.matchAll(/<code-field .*?>(.*)<\/code-field>/g)].map(d=>d[1]);if(u)for(let d=0;d<u.length;d++){const m=u[d];m.includes("\\\\")||(a=a.replace(m,m.replaceAll("\\","\\\\")))}}catch(o){return console.log("### 유효 문자열을 JSON에 적합한 문자열로 변환시키는 과정에서 오류 발생! ###"),console.log(o),console.log(l),null}try{return JSON.parse(a)}catch(o){return console.log("### JSON 문자열을 최종 파싱하는 과정에서 오류 발생! ###"),console.log(o),console.log(l),console.log(a),null}}return null},loadHTMLToKEditorContent(e){console.log("### 로드시킬 HTML 텍스트 ###"),console.log(e);const t=new DOMParser().parseFromString(e,"text/html");t.querySelectorAll("div.row").forEach(o=>{let s=0;if($(o).children('[class^="col-sm-"]').each(function(){var u=$(this)[0];const d=u.className.match(/col-sm-(\d+)/);if(d){const m=parseInt(d[1],10);s+=m}}),s!==12){const u=document.createElement("div");u.setAttribute("class","col-sm-12"),$(o).children('[class^="col-sm-"]').each(function(){var d=$(this)[0];Array.from(d.children).forEach(m=>{u.appendChild(m)})}),o.innerHTML="",o.appendChild(u)}});let c=!1;if(t.querySelectorAll("div.row").forEach(o=>{o.parentElement.tagName.toLowerCase()!=="section"&&(c=!0)}),t.querySelectorAll("section").forEach(o=>{o.children.length!==1&&(c=!0)}),c){const o=u=>{const d=u.parentElement;for(;u.firstChild;)d.insertBefore(u.firstChild,u);d.removeChild(u)};(u=>{t.querySelectorAll(u).forEach(d=>{o(d)})})("section"),t.querySelectorAll("div.row").forEach(u=>{const d=document.createElement("section");u.parentElement.insertBefore(d,u),d.appendChild(u)})}if(t.querySelectorAll('[class^="col-sm-"]').forEach(o=>{o.setAttribute("data-type","container-content")}),Array.from(t.querySelectorAll("*")).filter(o=>o.tagName.toLowerCase().endsWith("-field")).forEach(o=>{if(["name"].forEach(u=>{if(o.hasAttribute(u)){const d=o.getAttribute(u).match(/[가-힣a-zA-Z0-9_\-. ]/g),m=d?d.join(""):u;o.setAttribute(u,m)}}),o.hasAttribute("items")){if(o.getAttribute("items").length==0)o.setAttribute("items","[]");else if(o.getAttribute("items")!=="[]")try{let u=JSON.parse(o.getAttribute("items").replace(/'/g,'"').replace(/[ ]*,[ ]*\.\.\.[ ]*,[ ]*/,",")),d=[];u.forEach(m=>{Object.keys(m).forEach(_=>{const y=m[_],h=_.match(/[가-힣a-zA-Z0-9_\-. ]/g),G=y.match(/[가-힣a-zA-Z0-9_\-. ]/g),re=h?h.join(""):"",de=G?G.join(""):"";d.push({[re]:de})})}),o.setAttribute("items",JSON.stringify(d))}catch(u){console.log(u),o.setAttribute("items","[]")}}const s=document.createElement("div");if(s.setAttribute("id",`vuemount_${crypto.randomUUID()}`),this.generator.avaliableComponentTagNames.includes(o.tagName.toLowerCase()))o.parentNode.insertBefore(s,o),s.appendChild(o);else if(o.hasAttribute("items")){const u=document.createElement("select-field");u.setAttribute("name",o.getAttribute("name")??"name"),u.setAttribute("alias",o.getAttribute("alias")??"alias"),u.setAttribute("items",o.getAttribute("items")??"[]"),o.parentNode.insertBefore(s,o),s.appendChild(u),o.parentNode.removeChild(o)}else if(o.hasAttribute("name")||o.hasAttribute("alias")){const u=document.createElement("text-field");u.setAttribute("name",o.getAttribute("name")??"name"),u.setAttribute("alias",o.getAttribute("alias")??"alias"),o.parentNode.insertBefore(s,o),s.appendChild(u),o.parentNode.removeChild(o)}else o.parentNode.removeChild(o)}),t.body.querySelectorAll("section").length==0){const o=Array.from(t.body.querySelectorAll(".row"));t.body.innerHTML=o.map(s=>{const u=document.createElement("section");return u.innerHTML=s.outerHTML,u.outerHTML}).join("").replace(/&quot;/g,"'")}Array.from(t.body.querySelectorAll("section")).forEach(o=>{o.setAttribute("class","keditor-container")});const a=Array.from(t.body.children).map(o=>o.outerHTML).join("").replace(/&quot;/g,"'").replace("<br>",`
`);return console.log("### 로드된 유효 HTML 텍스트 ###"),console.log(a),a},applyNewSrcToMashup(e){this.kEditorInput=e,this.mashupKey+=1,this.currentTabName==="preview"&&this.$nextTick(()=>{this.applyToPreviewTab()})},getModifiedPrevFormOutput(e){const t=new DOMParser().parseFromString(this.prevFormOutput,"text/html");e.forEach(l=>{if(l.action==="addAsChild"){const r=t.querySelector(l.targetCSSSelector),a=new DOMParser().parseFromString(l.tagValue,"text/html");r.appendChild(a.body.firstChild)}else if(l.action==="addAfter"){const r=t.querySelector(l.targetCSSSelector),a=new DOMParser().parseFromString(l.tagValue,"text/html");r.parentNode.insertBefore(a.body.firstChild,r.nextSibling)}else if(l.action=="replace"){const r=t.querySelector(l.targetCSSSelector),a=new DOMParser().parseFromString(l.tagValue,"text/html");r.parentNode.replaceChild(a.body.firstChild,r)}else if(l.action==="delete"){const r=t.querySelector(l.targetCSSSelector);r.parentNode.removeChild(r)}});const c=t.body.outerHTML.replace(/&quot;/g,"'").replace("<br>",`
`);return console.log("### 수정된 이전 폼 출력 ###"),console.log(c),c},applyToPreviewTab(){var e=this;e.isShowPreview=!1,e.$try({context:e,action:async()=>{e.previewHTML=e.keditorContentHTMLToDynamicFormHTML(e.$refs.mashup.getKEditorContentHtml())},onFail:()=>{e.previewHTML=""}}),e.previewFormValues={},e.isShowPreview=!0,e.$nextTick(()=>{e.dev.previewFormValues=JSON.stringify(e.previewFormValues)})},async deleteForm(){var e=this;e.$try({context:e,action:async()=>{await this.backend.deleteDefinition(this.loadFormId,{type:"form"}),this.isOpenDeleteDialog=!1,await this.$router.push("/ui-definitions/chat"),window.location.reload()},successMsg:"삭제되었습니다."})}},beforeDestroy(){this.kEditorInput=null},async beforeRouteLeave(e,t,c){this.isAIUpdated||this.$refs.mashup.getKEditorContentHtml()!=this.kEditorContentBeforeSave?window.confirm("You have unsaved changes. Are you sure you want to leave?")?c():c(!1):c()}},Et={class:"no-scrollbar"},Mt={class:"d-flex flex-row-reverse",style:{height:"0px",position:"relative",bottom:"35px",left:"10px"}},Ut=p("편집"),Ft=p("미리보기"),Pt={key:1,class:"d-flex align-center justify-center fill-height"},$t=p("적용"),It=p("제출"),Ot={key:1,class:"d-flex align-center justify-center fill-height"},Nt={class:"d-flex flex-row-reverse",style:{height:"0px",position:"relative",bottom:"35px",left:"10px"}};function Lt(e,t,c,l,r,a){const o=A("Icon"),s=A("TrashIcon"),u=A("Chat"),d=A("mashup"),m=A("DynamicForm"),_=A("AppBaseCard"),y=A("form-design-save-panel");return f(),b(T,null,[i(P,{elevation:"10",style:{"background-color":"rgba(255, 255, 255, 0)"}},{default:n(()=>[i(_,null,{leftpart:n(()=>[v("div",Et,[i(u,{chatInfo:e.chatInfo,messages:e.messages,userInfo:e.userInfo,type:"form",onSendMessage:a.beforeSendMessage,onSendEditedMessage:e.sendEditedMessage,onStopMessage:e.stopMessage},{"custom-tools":n(()=>[v("div",Mt,[i(E,null,{activator:n(({props:h})=>[i(g,M(h,{icon:"",variant:"text",class:"text-medium-emphasis",onClick:a.openSaveDialog}),{default:n(()=>[i(o,{icon:"material-symbols:save",width:"24",height:"24"})]),_:2},1040,["onClick"])]),default:n(()=>[v("span",null,w(e.$t("uiDefinition.save")),1)]),_:1}),i(E,null,{activator:n(({props:h})=>[e.isLoadedForm?(f(),V(g,M({key:0},h,{icon:"",variant:"text",class:"text-medium-emphasis",onClick:a.openDeleteDialog}),{default:n(()=>[i(s,{size:"24"})]),_:2},1040,["onClick"])):K("",!0)]),default:n(()=>[v("span",null,w(e.$t("uiDefinition.deleteForm")),1)]),_:1})])]),_:1},8,["chatInfo","messages","userInfo","onSendMessage","onSendEditedMessage","onStopMessage"])])]),rightpart:n(()=>[i(te,{modelValue:e.currentTabName,"onUpdate:modelValue":t[0]||(t[0]=h=>e.currentTabName=h),style:{position:"fixed","z-index":"999"},class:"text-black","fixed-tabs":""},{default:n(()=>[i(H,{value:"edit"},{default:n(()=>[Ut]),_:1}),i(H,{value:"preview"},{default:n(()=>[Ft]),_:1})]),_:1},8,["modelValue"]),i(se,{modelValue:e.currentTabName,"onUpdate:modelValue":t[4]||(t[4]=h=>e.currentTabName=h),class:"fill-height"},{default:n(()=>[i(R,{value:"edit",class:"fill-height mt-15",style:{"overflow-y":"auto"}},{default:n(()=>[e.isShowMashup?(f(),V(d,{ref:"mashup",modelValue:e.kEditorInput,"onUpdate:modelValue":t[1]||(t[1]=h=>e.kEditorInput=h),key:e.mashupKey,onOnSaveFormDefinition:a.saveFormDefinition,onOnInitKEditorContent:a.updateKEditorContentBeforeSave},null,8,["modelValue","onOnSaveFormDefinition","onOnInitKEditorContent"])):(f(),b("div",Pt,[i(Y,{color:"primary",indeterminate:""})]))]),_:1}),i(R,{value:"preview",class:"fill-height mt-15 pa-5",style:{"overflow-y":"auto"}},{default:n(()=>[e.isShowPreview?(f(),b(T,{key:0},[i(m,{ref:"dynamicForm",formHTML:e.previewHTML,modelValue:e.previewFormValues,"onUpdate:modelValue":t[2]||(t[2]=h=>e.previewFormValues=h)},null,8,["formHTML","modelValue"]),e.dev.isDevMode?(f(),b(T,{key:0},[i(W,{label:"previewFormValuesToTest",rows:"10",modelValue:e.dev.previewFormValues,"onUpdate:modelValue":t[3]||(t[3]=h=>e.dev.previewFormValues=h)},null,8,["modelValue"]),i(g,{color:"primary",class:"full-width my-5",onClick:a.onClickPreviewApplyButton},{default:n(()=>[$t]),_:1},8,["onClick"])],64)):K("",!0),i(g,{color:"primary",class:"full-width",onClick:a.onClickPreviewSubmitButton},{default:n(()=>[It]),_:1},8,["onClick"])],64)):(f(),b("div",Ot,[i(Y,{color:"primary",indeterminate:""})]))]),_:1})]),_:1},8,["modelValue"])]),mobileLeftContent:n(()=>[i(u,{chatInfo:e.chatInfo,messages:e.messages,userInfo:e.userInfo,type:"form",onSendMessage:a.beforeSendMessage,onSendEditedMessage:e.sendEditedMessage,onStopMessage:e.stopMessage},{"custom-tools":n(()=>[v("div",Nt,[i(E,null,{activator:n(({props:h})=>[i(g,M(h,{icon:"",variant:"text",class:"text-medium-emphasis",onClick:a.openSaveDialog}),{default:n(()=>[i(o,{icon:"material-symbols:save",width:"24",height:"24"})]),_:2},1040,["onClick"])]),default:n(()=>[v("span",null,w(e.$t("uiDefinition.save")),1)]),_:1}),i(E,{location:"bottom"},{activator:n(({props:h})=>[e.isLoadedForm?(f(),V(g,M({key:0},h,{icon:"",variant:"text",class:"text-medium-emphasis",onClick:a.openDeleteDialog}),{default:n(()=>[i(s,{size:"24"})]),_:2},1040,["onClick"])):K("",!0)]),default:n(()=>[v("span",null,w(e.$t("uiDefinition.deleteForm")),1)]),_:1})])]),_:1},8,["chatInfo","messages","userInfo","onSendMessage","onSendEditedMessage","onStopMessage"])]),_:1})]),_:1}),i(L,{modelValue:e.isOpenSaveDialog,"onUpdate:modelValue":t[6]||(t[6]=h=>e.isOpenSaveDialog=h)},{default:n(()=>[i(y,{onOnClose:t[5]||(t[5]=h=>e.isOpenSaveDialog=!1),onOnSave:a.tryToSaveFormDefinition,savedId:e.loadFormId==="chat"?null:e.loadFormId,formNameByUrl:e.formNameByUrl},null,8,["onOnSave","savedId","formNameByUrl"])]),_:1},8,["modelValue"]),i(L,{modelValue:e.isOpenDeleteDialog,"onUpdate:modelValue":t[8]||(t[8]=h=>e.isOpenDeleteDialog=h),"max-width":"500"},{default:n(()=>[i(P,null,{default:n(()=>[i(N,null,{default:n(()=>[p(w(e.$t("uiDefinition.deleteFormMessage")),1)]),_:1}),i(z,{class:"justify-center pt-0"},{default:n(()=>[i(g,{color:"primary",variant:"flat",onClick:a.deleteForm},{default:n(()=>[p(w(e.$t("uiDefinition.delete")),1)]),_:1},8,["onClick"]),i(g,{color:"error",variant:"flat",onClick:t[7]||(t[7]=h=>e.isOpenDeleteDialog=!1)},{default:n(()=>[p(w(e.$t("uiDefinition.cancel")),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}const Yt=I(Dt,[["render",Lt],["__scopeId","data-v-dd4030c5"]]);export{Yt as default};
